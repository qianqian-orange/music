{"version":3,"sources":["webpack:///./src/views/Singer/index.vue?196c","webpack:///./src/model/singer.js","webpack:///src/views/Singer/index.vue","webpack:///./src/views/Singer/index.vue?b2d5","webpack:///./src/views/Singer/index.vue","webpack:///./src/views/Singer/index.vue?4c5e"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","attrs","handleScroll","directives","name","rawName","value","loading","expression","_l","group","index","key","refInFor","_v","_s","text","singer","id","on","$event","gotoDetail","serial","_e","stopPropagation","preventDefault","handleTouchStart","handleTouchMove","class","active","currentIndex","staticRenderFns","Singer","letter","songs","image","data","startY","startIndex","groups","mixins","bottom","methods","e","targetTouches","clientY","$refs","findIndex","scrollView","scrollToElement","cue","innerHTML","interval","length","pos","y","style","top","i","offsetTop","$router","history","push","path","components","ScrollView","Loading","created","Fsinger_id","Fsinger_name","Fsinger_mid","Findex","activated","$nextTick","component"],"mappings":"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","file":"public/js/chunk-d29b1f78.4021834e.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"singer\"},[_c('ScrollView',{ref:\"scrollView\",attrs:{\"handleScroll\":_vm.handleScroll}},[_c('ul',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.loading),expression:\"!loading\"}]},_vm._l((_vm.groups),function(group,index){return _c('li',{key:index,ref:\"group\",refInFor:true,staticClass:\"group\"},[_c('h1',{staticClass:\"title\"},[_vm._v(_vm._s(group.text))]),_c('ul',{staticClass:\"singerList\"},_vm._l((group.singers),function(singer){return _c('li',{key:singer.id,staticClass:\"item\",on:{\"click\":function($event){return _vm.gotoDetail(singer.serial)}}},[_c('img',{directives:[{name:\"lazy\",rawName:\"v-lazy\",value:(singer.image),expression:\"singer.image\"}],attrs:{\"alt\":\"avatar\"}}),_c('p',{staticClass:\"name\"},[_vm._v(_vm._s(singer.name))])])}),0)])}),0)]),(_vm.loading)?_c('Loading'):_vm._e(),_c('h1',{ref:\"cue\",staticClass:\"cue title\"},[_vm._v(\"热门\")]),_c('ul',{staticClass:\"letterList\",on:{\"touchstart\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.handleTouchStart($event)},\"touchmove\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.handleTouchMove($event)}}},_vm._l((_vm.groups),function(group,index){return _c('li',{key:index,ref:\"letter\",refInFor:true,staticClass:\"item\",class:{active: _vm.currentIndex === index}},[_vm._v(\" \"+_vm._s(group.text === '热门' ? '热' : group.text)+\" \")])}),0),_c('transition',{attrs:{\"name\":\"detail\"}},[_c('router-view')],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","class Singer {\n  constructor({\n    name,\n    serial,\n    letter,\n    id,\n    songs = [],\n  }) {\n    this.name = name;\n    this.serial = serial;\n    this.letter = letter;\n    this.image = `https://y.gtimg.cn/music/photo_new/T001R300x300M000${serial}.jpg?max_age=2592000`;\n    this.id = id;\n    this.songs = songs;\n  }\n}\n\nexport default Singer;\n","<template>\n  <div class=\"singer\">\n    <ScrollView ref=\"scrollView\" :handleScroll=\"handleScroll\">\n      <ul v-show=\"!loading\">\n        <li v-for=\"(group, index) in groups\" :key=\"index\" ref=\"group\" class=\"group\">\n          <h1 class=\"title\">{{ group.text }}</h1>\n          <ul class=\"singerList\">\n            <li v-for=\"singer in group.singers\" :key=\"singer.id\" class=\"item\" @click=\"gotoDetail(singer.serial)\">\n              <img v-lazy=\"singer.image\" alt=\"avatar\">\n              <p class=\"name\">{{ singer.name }}</p>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </ScrollView>\n    <Loading v-if=\"loading\" />\n    <h1 class=\"cue title\" ref=\"cue\">热门</h1>\n    <ul class=\"letterList\" @touchstart.stop.prevent=\"handleTouchStart\" @touchmove.stop.prevent=\"handleTouchMove\">\n      <li class=\"item\" :class=\"{active: currentIndex === index}\" v-for=\"(group, index) in groups\" :key=\"index\" ref=\"letter\">\n        {{ group.text === '热门' ? '热' : group.text }}\n      </li>\n    </ul>\n    <transition name=\"detail\">\n      <router-view></router-view>\n    </transition>\n  </div>\n</template>\n<script>\nimport { mapMutations } from 'vuex';\nimport ScrollView from '@/components/ScrollView/index.vue';\nimport Loading from '@/components/Loading/index.vue';\nimport Singer from '@/model/singer';\nimport { jsonp } from '@/utils';\nimport {\n  singerListParam,\n  SUCCESS,\n  letters,\n} from '@/config';\nimport { BATCH_ADD } from '@/store/modules/singer/mutation-types';\nimport mixin from '@/mixin';\n\nconst { bottom } = mixin;\nexport default {\n  name: 'Singer',\n  data() {\n    return {\n      currentIndex: 0,\n      loading: false,\n      startY: 0,\n      startIndex: 0,\n      groups: [{ text: '热门', singers: [] }].concat(Object.keys(letters).map(key => ({\n        text: key,\n        singers: [],\n      }))),\n    };\n  },\n  mixins: [bottom],\n  methods: {\n    handleTouchStart(e) {\n      this.startY = e.targetTouches[0].clientY;\n      this.startIndex = this.$refs.letter.findIndex(item => item === e.target);\n      this.currentIndex = this.startIndex;\n      this.$refs.scrollView.scrollToElement(this.$refs.group[this.currentIndex]);\n      this.$refs.cue.innerHTML = this.groups[this.currentIndex].text;\n    },\n    handleTouchMove(e) {\n      const interval = this.startIndex + Math.floor((e.targetTouches[0].clientY - this.startY) / 18);\n      if (interval >= 0 && interval < this.groups.length) {\n        this.currentIndex = interval;\n        this.$refs.scrollView.scrollToElement(this.$refs.group[this.currentIndex]);\n        this.$refs.cue.innerHTML = this.groups[this.currentIndex].text;\n      }\n    },\n    handleScroll(pos) {\n      if (pos.y > 0) {\n        this.$refs.cue.style.top = `${pos.y}px`;\n        return;\n      }\n      const y = Math.abs(pos.y);\n      const group = this.$refs.group;\n      const cue = this.$refs.cue;\n      for (let i = group.length - 1; i >= 0; --i) {\n        if (y >= group[i].offsetTop) {\n          if (this.currentIndex !== i) {\n            cue.innerHTML = this.groups[i].text;\n            this.currentIndex = i;\n          }\n\n          if (i < group.length - 1) {\n            const interval = group[i + 1].offsetTop - y;\n            cue.style.top = `${-30 + (interval <= 30 ? interval : 30)}px`;\n          } else {\n            cue.style.top = 0;\n          }\n          return;\n        }\n      }\n    },\n    gotoDetail(serial) {\n      this.$router.history.push({\n        path: `/singer/${serial}`,\n      });\n    },\n    ...mapMutations('singer', [BATCH_ADD]),\n  },\n  components: {\n    ScrollView,\n    Loading,\n  },\n  created() {\n    this.loading = true;\n    jsonp('https://c.y.qq.com/v8/fcg-bin/v8.fcg', singerListParam)\n      .then((data) => {\n        if (data.code === SUCCESS) {\n          const list = data.data.list.map(singer => new Singer({\n            id: singer.Fsinger_id,\n            name: singer.Fsinger_name,\n            serial: singer.Fsinger_mid,\n            letter: singer.Findex,\n          }));\n          this.BATCH_ADD(list);\n          for (let i = 0; i < 10; ++i) {\n            this.groups[0].singers.push(list[i]);\n          }\n          list.forEach((singer) => {\n            if (letters[singer.letter]) {\n              this.groups[letters[singer.letter]].singers.push(singer);\n            }\n          });\n          this.groups = this.groups.filter(item => item.singers.length > 0);\n          this.loading = false;\n          this.refresh();\n        }\n      });\n  },\n  activated() {\n    this.currentIndex = 0;\n    this.$nextTick(() => {\n      this.$refs.cue.innerHTML = '热门';\n    });\n  },\n};\n\n</script>\n<style scoped lang=\"scss\">\n.singer {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  color: hsla(0, 0%, 100%, .5);\n  overflow: hidden;\n\n  .group {\n    padding-bottom: 20px;\n\n    &:last-child {\n      padding-bottom: 0;\n    }\n\n    >.singerList {\n      >.item {\n        display: flex;\n        align-items: center;\n        padding-left: 30px;\n        padding-top: 20px;\n\n        >img {\n          width: 50px;\n          height: 50px;\n          margin-right: 20px;\n          border-radius: 50%;\n        }\n\n        >.name {\n          font-size: $font-size-medium;\n        }\n      }\n    }\n  }\n\n  .title {\n    padding-left: 20px;\n    height: 30px;\n    line-height: 30px;\n    font-size: $font-size-small;\n    background: #333;\n  }\n\n  .letterList {\n    position: absolute;\n    top: 50%;\n    right: 0;\n    transform: translateY(-50%);\n    padding: 20px 0;\n    background: rgba(0, 0, 0, .3);\n\n    >.item {\n      width: 2ch;\n      padding: 3px 3px 3px 0;\n      line-height: 1;\n      color: hsla(0, 0%, 100%, .5);\n      font-size: $font-size-small;\n      text-align: center;\n      white-space: nowrap;\n      overflow: hidden;\n\n      &.active {\n        color: $color-theme;\n      }\n    }\n  }\n\n  .cue {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n  }\n}\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1c85fa06&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=1c85fa06&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1c85fa06\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=1c85fa06&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=1c85fa06&scoped=true&lang=scss&\""],"sourceRoot":""}